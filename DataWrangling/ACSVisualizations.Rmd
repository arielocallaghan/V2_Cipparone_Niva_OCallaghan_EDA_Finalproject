---
title: "QuickPresentationAnalysis"
author: "Hugh Cipparone"
date: '2022-11-30'
output: html_document
---

```{r}
library(psych)
library(stargazer)
library(vtable)
library(tidyverse)
library(gt)
```


#Goals and Visualizations
- Summary statistics of PA population broadly
  - weighted average of each metric by percentage of total population
- summary statistics with spread of county data to capture general differences
- cowplot with all of their values for each of the indices
- - could also be cowplot with all of their ranks for each of the indices
- - could also do above cowplot over time



```{r}

pa.2019<-read.csv("./RawData/pa.2019.csv")

pa.2019.clean <- pa.2019 %>% 
  pivot_wider(names_from=variable, values_from=estimate)%>% 
  select(!c(GEOID,moe)) %>% 
  group_by(NAME) %>% 
  summarise(totpop=sum(totpop, na.rm=TRUE),
            medage=sum(medage, na.rm=TRUE),
            totpoprace=sum(totpoprace, na.rm=TRUE),
            totpopwhite=sum(totpopwhite, na.rm=TRUE),
            totpopeduc=sum(totpopeduc, na.rm=TRUE),
            bachdegree=sum(bachdegree, na.rm=TRUE),
            medincome=sum(medincome, na.rm=TRUE)) %>% 
  mutate(perc.white = totpopwhite/totpop*100) %>% 
  mutate(perc.bachdegree = bachdegree/totpop*100) %>% 
  separate(NAME, into = c("County", "post","post1")) %>% 
  select(!c(post, post1))


pop<-ggplot(pa.2019.clean, aes(County, totpop, fill=County))+
  geom_bar(stat="identity")+
  ylab("Total Population")+
  xlab("County")+
  theme(axis.text.x = element_text(angle = 90))

race<-ggplot(pa.2019.clean, aes(County, perc.white, fill=County))+
  geom_bar(stat="identity")+
  ylab("% White")+
  xlab("County")+
  theme(axis.text.x = element_text(angle = 90))

income<-ggplot(pa.2019.clean, aes(County, medincome, fill=County))+
  geom_bar(stat="identity")+
  ylab("Median Income")+
  xlab("County")+
  theme(axis.text.x = element_text(angle = 90))
income

```


#summary statistics of PA population broadly
```{r}

pa.2019.summary.table<-pa.2019.clean %>% 
  select(totpop,medage,
         perc.white,
         perc.bachdegree,
         medincome) %>% 
  mutate(medage.w=medage*(totpop/11847115), #numerical value calculated by summing the total population values for all counties
         perc.white.w = perc.white*(totpop/11847115), 
         perc.bachdegree.w=perc.bachdegree*(totpop/11847115),
         medincome.w=medincome*(totpop/11847115)) %>% 
  select(totpop,
         medage.w,
         perc.white.w,
         perc.bachdegree.w,
         medincome.w) %>% 
  summarize(median.age=sum(medage.w), 
            average.pop=sum(totpop), 
            average.perc.w=sum(perc.white.w), 
            average.perc.bachdegree=sum(perc.bachdegree.w), 
            median.income=sum(medincome.w)) %>% 
  rename("Average Population" = average.pop, 
       "Median Age" = median.age, 
       "Percent White" = average.perc.w, 
       "Percent Bachelors" = average.perc.bachdegree, 
       "Median Income" = median.income) %>% 
  gt() %>% 
    tab_header(title = "Pennsylvania Demographic Characteristics") %>% 
    tab_source_note(source_note = "Population-weighted county data sourced from American Community Survey 1-year estimates")
  

pa.2019.summary.table
  
```

#summary statistics on county data
```{r}



```





