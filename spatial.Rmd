---
title: "Spatial_health"
author: "Ariel O'Callaghan"
date: "2022-12-09"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

#get packages 

getwd()
#install.packages("tidyverse")
library(tidyverse)

#install.packages("sf")
library(sf)

#install.packages("leaflet")
library(leaflet)

#install.packages("mapview")
library(mapview)

#install.packages("leaflet")
library(leaflet)

#install.packages("lubridate")
library(lubridate)

#install.packages(dplyr)
library(dplyr)

#install.packages("ggplot2")
library(ggplot2)

library(RColorBrewer)

par(mar=c(3,4,2,2))
display.brewer.all()

#Disable on-the-fly projections - code from lab sheet 
sf::sf_use_s2(FALSE)

#read in spatial data frame and filter for Pennsylvania 

counties_sf <- st_read('./RawData/cb_2018_us_county_20m.shp')%>% 
  filter(STATEFP == 42) #42|PA|Pennsylvania|01779798

#check data frame information 
colnames(counties_sf)

st_crs(counties_sf) 

nrow(counties_sf)

#Reveal the extent of this dataset via the st_bbox() function
st_bbox(counties_sf)

#View the data
head(counties_sf)

#Plot the county data, colored by area of land in each county
mapView(counties_sf, zcol = "ALAND")

#read in health data frame to join with spatial datframe 
healthdf<- read.csv("./ProcessedData/healthdf.csv",stringsAsFactors = TRUE)

counties_sf$NAME<- as.character(counties_sf$NAME)
class(counties_sf$NAME)

healthdf$County<- as.character(healthdf$County)
class(healthdf$County)

(healthdf)

#counties_sf<- counties_sf %>% 
 # rename(NAME== County)
  
#join data sets together 
counties_sf_join <-  merge(x = counties_sf,
                           y = healthdf, 
                           by.x = "NAME", 
                           by.y = "County" )
```


```{r setup, include=FALSE}
#Visualizations 

#filter for 2019 only to plot
Health_Data_2019<-counties_sf_join%>%
  filter(year==2019)

#plot 2019 data
#Health.z.2019
mapview(Health_Data_2019, 
        zcol = 'Health.Factors.Z.Score', 
        col.regions = brewer.pal(10,'OrRd'))

#Heath.rank2019
mapview(Health_Data_2019, 
        zcol = 'Health.Outcomes.Rank', 
        col.regions = brewer.pal(20, 'Blues'))
      
#plot 2010 Data
Health_Data_2010<-counties_sf_join%>%
  filter(year==2010)

#Health Z score 2010
mapview(Health_Data_2010, 
        zcol = 'Health.Factors.Z.Score', 
        col.regions = brewer.pal(5, 'OrRd'))

#'OrRd'
#Heath.rank2010 
mapview(Health_Data_2010, 
        zcol = 'Health.Outcomes.Rank', 
        col.regions = brewer.pal(9, 'Blues'))

#library(leafsync)
#library(latt)

#can't figure correct way to name plots to show side by side

#latticeview(Health.z.2010, Health.z.2019)
#latticeview(Heath.rank2010,Heath.rank2019)

```
